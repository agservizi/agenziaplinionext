(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75131,e=>{"use strict";var t=e.i(47167),s=e.i(43476),a=e.i(71645);let l=["Pagamenti","Telefonia","Energia","SPID / PEC / Firma Digitale","Spedizioni","Consulenza Web / Gestionale"];function n(){let e=t.default.env.NEXT_PUBLIC_BOOKING_API_BASE||"",[n,r]=(0,a.useState)(0),[i,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[x,u]=(0,a.useState)([]),[m,b]=(0,a.useState)(null),[p,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[N,v]=(0,a.useState)(""),[w,C]=(0,a.useState)(""),[S,E]=(0,a.useState)(""),[P,k]=(0,a.useState)("idle"),[z,T]=(0,a.useState)(""),O=(0,a.useMemo)(()=>0===n?!!i:1===n?!!(d&&m):2===n&&!!(y&&N&&w),[d,N,y,w,m,i,n]);async function I(){if("loading"!==P&&m){k("loading"),T("");try{let t=await fetch(`${e}/api/booking`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:i,date:d,time:m.label,name:y,email:N,phone:w,notes:S})});if(!t.ok){let e=await t.json();throw Error(e?.message||"Prenotazione non riuscita")}k("success"),T("Prenotazione confermata! Riceverai una email di conferma."),r(3)}catch(e){k("error"),T(e instanceof Error?e.message:"Si è verificato un errore. Riprova.")}}}function _(){O&&r(e=>Math.min(e+1,3))}return(0,a.useEffect)(()=>{d&&i&&(h(!0),f(""),b(null),fetch(`${e}/api/booking/availability?date=${d}&service=${encodeURIComponent(i)}`).then(async e=>{if(!e.ok){let t=await e.json();throw Error(t?.message||"Errore disponibilità")}return e.json()}).then(e=>u(e.slots||[])).catch(e=>f(e instanceof Error?e.message:"Errore")).finally(()=>h(!1)))},[d,i]),(0,s.jsxs)("div",{className:"space-y-8",children:[e?null:(0,s.jsx)("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-700",children:"Configura NEXT_PUBLIC_BOOKING_API_BASE per abilitare le prenotazioni."}),(0,s.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:["Servizio","Data & Ora","Dati","Conferma"].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:t<=n?"flex h-9 w-9 items-center justify-center rounded-full bg-cyan-600 text-xs font-semibold text-white":"flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-xs font-semibold text-slate-400",children:t+1}),(0,s.jsx)("span",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500",children:e}),t<3?(0,s.jsx)("span",{className:"h-px w-6 bg-slate-200"}):null]},e))}),0===n?(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:l.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>o(e),className:i===e?"rounded-2xl border border-cyan-500 bg-cyan-50 px-5 py-4 text-left text-sm font-semibold text-cyan-700":"rounded-2xl border border-slate-200 bg-white px-5 py-4 text-left text-sm font-semibold text-slate-700",children:e},e))}):null,1===n?(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-[0.9fr_1.1fr]",children:[(0,s.jsxs)("label",{className:"space-y-2 text-sm text-slate-700",children:["Seleziona una data",(0,s.jsx)("input",{type:"date",value:d,onChange:e=>c(e.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 outline-none transition focus:border-cyan-500"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Slot disponibili"}),p?(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Caricamento disponibilità..."}):null,g?(0,s.jsx)("p",{className:"text-sm text-rose-600",children:g}):null,p||g||!d?null:x.length?(0,s.jsx)("div",{className:"grid gap-3 sm:grid-cols-3",children:x.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>b(e),className:m?.start===e.start?"rounded-2xl border border-cyan-500 bg-cyan-50 px-4 py-3 text-sm font-semibold text-cyan-700":"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm font-semibold text-slate-700",children:e.label},e.start))}):(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Nessuno slot disponibile."})]})]}):null,2===n?(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("label",{className:"space-y-2 text-sm text-slate-700",children:["Nome e cognome",(0,s.jsx)("input",{value:y,onChange:e=>j(e.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 outline-none transition focus:border-cyan-500",required:!0})]}),(0,s.jsxs)("label",{className:"space-y-2 text-sm text-slate-700",children:["Email",(0,s.jsx)("input",{type:"email",value:N,onChange:e=>v(e.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 outline-none transition focus:border-cyan-500",required:!0})]}),(0,s.jsxs)("label",{className:"space-y-2 text-sm text-slate-700",children:["Telefono",(0,s.jsx)("input",{value:w,onChange:e=>C(e.target.value),className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 outline-none transition focus:border-cyan-500",required:!0})]}),(0,s.jsxs)("label",{className:"space-y-2 text-sm text-slate-700 md:col-span-2",children:["Note (opzionali)",(0,s.jsx)("textarea",{value:S,onChange:e=>E(e.target.value),rows:4,className:"w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-900 outline-none transition focus:border-cyan-500"})]})]}):null,3===n?(0,s.jsxs)("div",{className:"rounded-3xl border border-slate-200 bg-slate-50 p-6",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:"Riepilogo appuntamento"}),(0,s.jsxs)("div",{className:"mt-4 grid gap-2 text-sm text-slate-600",children:[(0,s.jsxs)("p",{children:["Servizio: ",i]}),(0,s.jsxs)("p",{children:["Data: ",d]}),(0,s.jsxs)("p",{children:["Orario: ",m?.label]}),(0,s.jsxs)("p",{children:["Cliente: ",y]}),(0,s.jsxs)("p",{children:["Email: ",N]}),(0,s.jsxs)("p",{children:["Telefono: ",w]})]})]}):null,(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[n>0&&n<3?(0,s.jsx)("button",{type:"button",onClick:function(){r(e=>Math.max(e-1,0))},className:"rounded-full border border-slate-200 px-5 py-2 text-sm font-semibold text-slate-600",children:"Indietro"}):null,n<2?(0,s.jsx)("button",{type:"button",onClick:_,disabled:!O,className:"rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-300",children:"Continua"}):null,2===n?(0,s.jsx)("button",{type:"button",onClick:_,disabled:!O,className:"rounded-full bg-slate-900 px-5 py-2 text-sm font-semibold text-white transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:bg-slate-300",children:"Riepilogo"}):null,3===n?(0,s.jsx)("button",{type:"button",onClick:I,disabled:"loading"===P,className:"rounded-full bg-cyan-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-cyan-500 disabled:cursor-not-allowed disabled:bg-cyan-400",children:"loading"===P?"Prenotazione...":"Conferma prenotazione"}):null]}),z?(0,s.jsx)("p",{className:"success"===P?"text-sm text-emerald-600":"text-sm text-rose-600",children:z}):null]})]})}e.s(["default",()=>n])}]);